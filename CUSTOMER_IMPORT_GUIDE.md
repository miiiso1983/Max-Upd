# 📊 دليل استيراد العملاء من Excel - نظام MaxCon ERP

## 🎯 نظرة عامة

تم إنشاء نظام استيراد Excel مخصص لإضافة العملاء بشكل مجمع وسريع. النظام يتضمن:

- ✅ **قالب Excel مخصص** للعملاء فقط
- ✅ **واجهة استيراد سهلة** مع تعليمات واضحة
- ✅ **تحقق تلقائي** من البيانات
- ✅ **تقارير مفصلة** عن نتائج الاستيراد
- ✅ **معالجة الأخطاء** والبيانات المكررة

---

## 🔗 الروابط الجديدة

### **1. صفحة العملاء (محدثة):**
- **URL**: `http://127.0.0.1:8000/sales/customers`
- **الجديد**: زر "استيراد من Excel" بجانب "عميل جديد"

### **2. صفحة الاستيراد:**
- **URL**: `http://127.0.0.1:8000/sales/customers/import`
- **الميزات**: تعليمات، رفع ملف، تحميل قالب

### **3. تحميل قالب العملاء:**
- **URL**: `http://127.0.0.1:8000/sales/customers/import/template`
- **المحتوى**: ملف Excel مخصص للعملاء فقط

---

## 📋 مواصفات قالب العملاء

### **الأعمدة (21 عمود):**

#### **الحقول الإجبارية (مميزة بالأصفر):**
1. **اسم العميل*** - نص
2. **نوع العميل*** - قائمة منسدلة (فرد، صيدلية، عيادة، مستشفى، موزع، حكومي)
3. **الحالة*** - قائمة منسدلة (نشط، غير نشط)

#### **الحقول الاختيارية:**
4. الاسم بالعربية
5. رمز العميل (يتم إنشاؤه تلقائياً إذا ترك فارغاً)
6. البريد الإلكتروني
7. رقم الهاتف
8. رقم الموبايل
9. العنوان
10. المدينة
11. المحافظة (قائمة منسدلة - جميع المحافظات العراقية)
12. الرمز البريدي
13. الرقم الضريبي
14. رقم الترخيص
15. الشخص المسؤول
16. هاتف المسؤول
17. بريد المسؤول
18. الحد الائتماني (رقم)
19. شروط الدفع بالأيام (رقم)
20. نسبة الخصم % (رقم)
21. ملاحظات

### **البيانات النموذجية:**
- **صف 2**: صيدلية الشفاء (مثال كامل)
- **صف 3**: مستشفى بغداد التخصصي (مثال كامل)

---

## 🚀 طريقة الاستخدام

### **الخطوة 1: الوصول للنظام**
```
1. اذهب إلى: http://127.0.0.1:8000/sales/customers
2. اضغط على زر "استيراد من Excel" (الأخضر)
3. ستنتقل لصفحة الاستيراد
```

### **الخطوة 2: تحميل القالب**
```
1. في صفحة الاستيراد، اضغط "تحميل قالب العملاء"
2. احفظ الملف على جهازك
3. افتح الملف في Excel أو Google Sheets
```

### **الخطوة 3: تعبئة البيانات**
```
1. احذف البيانات النموذجية (الصفوف 2 و 3)
2. أدخل بيانات عملائك بدءاً من الصف 2
3. استخدم القوائم المنسدلة للحقول المحددة
4. تأكد من ملء الحقول الإجبارية (الصفراء)
5. احفظ الملف
```

### **الخطوة 4: رفع الملف**
```
1. ارجع لصفحة الاستيراد
2. اسحب الملف أو اضغط لاختياره
3. اضغط "استيراد العملاء"
4. انتظر معالجة البيانات
```

### **الخطوة 5: مراجعة النتائج**
```
1. ستظهر رسالة نجاح مع الإحصائيات
2. راجع أي أخطاء إن وجدت
3. تحقق من العملاء المضافين في القائمة
```

---

## ✅ ميزات النظام

### **🔍 التحقق التلقائي:**
- ✅ **الحقول الإجبارية**: التأكد من وجودها
- ✅ **البريد الإلكتروني**: تحقق من صحة التنسيق
- ✅ **الأرقام**: التأكد من كونها أرقام صحيحة
- ✅ **القوائم المنسدلة**: قيم محددة مسبقاً فقط
- ✅ **البيانات المكررة**: منع تكرار البريد أو الرمز

### **📊 تقارير مفصلة:**
- 🟢 **عدد العملاء المستوردين**: بنجاح
- 🟡 **عدد العملاء المكررين**: تم تجاهلهم
- 🔴 **عدد الأخطاء**: مع تفاصيل كل خطأ
- 📍 **رقم الصف**: لكل خطأ للإصلاح السريع

### **🛡️ الأمان والحماية:**
- ✅ **حد أقصى للملف**: 10 ميجابايت
- ✅ **أنواع ملفات محددة**: Excel فقط (.xlsx, .xls)
- ✅ **معالجة الأخطاء**: بدون توقف النظام
- ✅ **Transaction**: إما نجاح كامل أو إلغاء كامل
- ✅ **تسجيل المنشئ**: تتبع من أضاف العميل

---

## 📝 أمثلة على البيانات

### **مثال 1: صيدلية**
```
اسم العميل: صيدلية النور
نوع العميل: صيدلية
البريد: info@alnoor-pharmacy.com
الهاتف: 07901234567
العنوان: شارع الجامعة، بغداد
المحافظة: بغداد
الحالة: نشط
```

### **مثال 2: عيادة**
```
اسم العميل: عيادة الدكتور أحمد
نوع العميل: عيادة
البريد: dr.ahmed@clinic.com
الهاتف: 07902345678
العنوان: حي الجامعة، بغداد
المحافظة: بغداد
الحالة: نشط
```

### **مثال 3: مستشفى**
```
اسم العميل: مستشفى الكندي
نوع العميل: مستشفى
البريد: info@alkindi-hospital.com
الهاتف: 07903456789
العنوان: شارع الكندي، بغداد
المحافظة: بغداد
الحد الائتماني: 50000000
شروط الدفع: 60
الحالة: نشط
```

---

## ⚠️ نصائح مهمة

### **✅ افعل:**
- استخدم القوائم المنسدلة للحقول المحددة
- تأكد من صحة البريد الإلكتروني
- اكتب الأرقام بدون فواصل أو رموز
- احفظ نسخة احتياطية قبل الاستيراد
- اختبر مع عدد قليل من العملاء أولاً

### **❌ لا تفعل:**
- لا تحذف أو تعدل أسماء الأعمدة
- لا تترك الحقول الإجبارية فارغة
- لا تكرر البريد الإلكتروني أو رمز العميل
- لا تستخدم قيم غير موجودة في القوائم
- لا ترفع ملفات أكبر من 10 ميجابايت

---

## 🔧 استكشاف الأخطاء

### **خطأ: "اسم العميل مطلوب"**
- **الحل**: تأكد من ملء عمود "اسم العميل" لجميع الصفوف

### **خطأ: "نوع العميل غير صحيح"**
- **الحل**: استخدم القائمة المنسدلة أو اكتب: فرد، صيدلية، عيادة، مستشفى، موزع، حكومي

### **خطأ: "البريد الإلكتروني غير صحيح"**
- **الحل**: تأكد من تنسيق البريد: example@domain.com

### **خطأ: "عميل مكرر"**
- **الحل**: تحقق من عدم تكرار البريد الإلكتروني أو رمز العميل

### **خطأ: "الحد الائتماني يجب أن يكون رقم"**
- **الحل**: اكتب أرقام فقط بدون فواصل أو رموز

---

## 📞 الدعم الفني

في حالة وجود مشاكل:
- 📧 **البريد الإلكتروني**: support@maxcon-erp.com
- 📱 **الهاتف**: +964-XXX-XXXX
- 💬 **الدردشة المباشرة**: متوفرة في لوحة الإدارة

---

**✅ تم إنشاء هذا النظام بواسطة فريق MaxCon ERP - {{ date('Y/m/d') }}**
